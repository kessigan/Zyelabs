<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script>
	function myFunction(){
	var centre_no = document.getElementById("centre").value;

	
	$.ajaxSetup({
async: false
});
      $.get(database, function(data, status){

		for(count = 0; count < data[0].length; count++){
		
		
		if (data[0][count].centre_number == centre_no){
		document.getElementById('centre').innerHTML = "Pass Rate: " + passrate_2016;

		}
		}
	
	})}
	
	</script>

 </head>
  
  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand" href="#">Matric Results</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item active">
              <a class="nav-link" href="/">Home
                <span class="sr-only">(current)</span>
              </a>
            </li>
            
          </ul>
        </div>
      </div>
    </nav>


    <!-- Page Content -->
    <section class="py-5">
      <!-- Heading Row -->
            <div class="row my-4">
              <div class="col-lg-7">
                <canvas id="myChart"></canvas>
              </div>
              <!-- /.col-lg-8 -->
              <div class="col-lg-5">
                <h1>2016 Results Summary</h1>
                <h2>Key Measurements</h2>
				<p id ="part1"></p><b>
				<p id ="part2"></p>
				<p id ="part3"></p>
				<p id ="part4"></p>
				<p id ="part5"></p>
                
              </div>
              <!-- /.col-md-4 -->
            </div>
            <!-- /.row -->



            <!-- Content Row  -->
            <div class="row">
              <div class="col-md-4 mb-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h2 class="card-title">Breakdown by Province</h2>
                    <p class="card-text">This information is not currently available but may be added in future </p>
                  </div><!--
                  <div class="card-footer">
                    <a href="#" class="btn btn-primary">More Info</a>
                  </div>-->
                </div>
              </div>
              <!-- /.col-md-4 -->
              <div class="col-md-4 mb-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h2 class="card-title">Results per a school </h2>
					<form onsubmit="myFunction()">
					Enter Center Number: <input type="number" id = "centre">
					<input type="submit">
					</form>
                    <p class="card-text" id = "part6"></p>
                  </div><!--
                  <div class="card-footer">
                    <a href="#" class="btn btn-primary">More Info</a>
                  </div>-->
                </div>
              </div>
              <!-- /.col-md-4 -->
              <div class="col-md-4 mb-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h2 class="card-title">Key Dates</h2>
                    <h4 class="card-text" >Closing date for remarks - 19/01/2017</h4>
					<h4 class="card-text" >Closing date for rewrite - 15/03/2017</h4>
                    <p class="card-text"><a href="https://www.education.gov.za/Curriculum/NationalSeniorCertificate(NSC)Examinations/SecondChanceProgramme/tabid/956/Default.aspx">Click here for more information</a></p>
                  </div><!--
                  <div class="card-footer">
                    <a href="#" class="btn btn-primary">More Info</a>
                  </div>-->
                </div>
              </div>
              <!-- /.col-md-4 -->

            </div>
            <!-- /.row -->

    </section>

    <!-- Footer -->
    <footer class="py-5 bg-dark">
      <div class="container">
        
      </div>
      <!-- /.container -->
    </footer>
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  </body>
  <script>
  
  var rate2014sum = 0;
  var rate2015sum = 0;
  var rate2016sum= 0;
  var counter1 = 0;
  var counter2 = 0;
  var counter3 = 0;
  var counter25 = 0;
  var counter50= 0;
  var counter75 = 0;
  var counter100 = 0;
  database = "/getInfo";
		$.ajaxSetup({
async: false
});
      $.get(database, function(data, status){
        console.log(data[0][5]);
        console.log(data[0][5].passrate_2016);
		for(count = 0; count < data[0].length; count++){
		
		
		if (data[0][count].passrate_2014 >1){
		rate2014sum = rate2014sum + data[0][count].passrate_2014;
		counter1++;
		}
		if (data[0][count].passrate_2015 >1){
		rate2015sum = rate2015sum + data[0][count].passrate_2015;
		counter2++;
		}
		if (parseFloat(data[0][count].passrate_2016) >1){
		rate2016sum = rate2016sum + parseFloat(data[0][count].passrate_2016);
		counter3++;
		}
		
		if (parseFloat(data[0][count].passrate_2016) >75){counter100++;}
			else if (parseFloat(data[0][count].passrate_2016) >50){counter75++;}
			else if (parseFloat(data[0][count].passrate_2016) >20){counter50++;}
			else {counter25++;}
		
		}

		document.getElementById('part1').innerHTML = "Total Schools: " + counter3;
		document.getElementById('part2').innerHTML = "Greater than 75%: " + counter100;
		document.getElementById('part3').innerHTML = "Greater than 50%: " + counter75;
		document.getElementById('part4').innerHTML = "Greater than 25%: " + counter50;
		document.getElementById('part5').innerHTML = "Less than 25%: " + counter25;


    });

  
  var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'line',

    // The data for our dataset
    data: {
        labels: ["2014", "2015", "2016"],
        datasets: [{
            label: "Aggregate Pass Rate",
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [rate2014sum/counter1, rate2015sum/counter2, rate2016sum/counter3],
        }]
    },

    // Configuration options go here
    options: {}
});
  </script>
  
  
</html>
